<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding x86_64 Assembly Procedures - Fischer's Lab</title>
    <link rel="stylesheet" href="../style.css">
    <script src="https://kit.fontawesome.com/your-font-awesome-kit-id.js" crossorigin="anonymous"></script>
</head>
<body>
    <nav>
        <div class="nav-content">
            <h1 class="site-title">Fischer's Lab</h1>
            <ul>
                <li><a href="../index.html" class="nav-button">Home</a></li>
                <li><a href="../about.html" class="nav-button">About</a></li>
            </ul>
        </div>
    </nav>
    <main class="draft-content">
        <article>
            <div class="title-date-container">
                <h1 class="page-title">Understanding x86_64 Assembly Procedures</h1>
                <p class="draft-date">June 16, 2024</p>
            </div>
            <h2>Procedural Definitions:</h2>
            <p><b>Base Pointer (EBP/RBP)</b>: The base pointer is a register (<b>EBP</b> in 32-bit systems, <b>RBP</b> in 64-bit systems) that holds the memory address marking the <b>start of a function's stack frame</b>. It serves as a fixed reference point to access function parameters (above the base pointer) and local variables (below the base pointer).</p>
            <p><b>Stack Pointer (ESP/RSP)</b>: The stack pointer is a register (<b>ESP</b> in 32-bit systems, <b>RSP</b> in 64-bit systems) that tracks the <b>top of the stack</b>. It is automatically updated by the CPU during <b>push</b> and <b>pop</b> operations. The stack grows <b>downwards in memory</b>â€”as more variables are pushed onto the stack, the stack pointer is decremented (moving to lower memory addresses). Conversely, it is incremented as values are popped off the stack.</p>
            <h2>How It Works:</h2>
            <p><b>Returns</b>: After a procedure finishes, it must <b>clean up its stack frame</b> so that the stack pointer (<b>ESP</b>/<b>RSP</b>) points to the <b>return address</b>, which was pushed onto the stack by the caller before the procedure was called. To return a value to the caller, the procedure <b>places the return value</b> in the <b>EAX</b> register (in 32-bit systems) or the <b>RAX</b> register (in 64-bit systems). This return value can then be accessed by the caller immediately after the procedure returns.</p>
            <p><b>Parameters</b>: Parameters are passed by the caller either on the <b>stack</b> or via <b>registers</b> (depending on the architecture and calling convention). In 32-bit systems, parameters are typically pushed onto the stack and can be accessed by the called procedure as <b>offsets from the base pointer</b>. For example, the first parameter would be located at [<b>EBP + 8</b>].</p>
            <p><b>Return Address</b>: When a procedure is called using the <b>call</b> instruction, the CPU automatically <b>pushes the return address</b> (the address of the next instruction in the caller) onto the stack. This return address will be used by the called procedure when it finishes execution, allowing the program to return control to the correct point in the caller.</p>
            <p><b>Call and Ret</b>: The <b>call</b> instruction not only jumps to the target procedure but also <b>stores the return address</b> (the location of the next instruction after the call) onto the stack. When the procedure is ready to return, it uses the <b>ret</b> instruction to <b>pop the return address</b> off the stack and jump back to it. The <b>ret</b> instruction simply transfers control back to the caller by jumping to the return address, assuming the stack has been properly cleaned up by the procedure.</p>
            <h2>Example:</h2>
            <p>[Your example code or explanation here]</p>
            <h2>Experimenting:</h2>
            <p>[Your experimentation details or instructions here]</p>
        </article>
    </main>
    <footer>
        <div class="footer-icons">
            <a href="https://github.com/fischer36" target="_blank" aria-label="GitHub"><i class="fab fa-github"></i></a>
        </div>
    </footer>
</body>
</html>
